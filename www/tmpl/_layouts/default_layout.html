<!DOCTYPE html>
<html>
<head>
<title><?=SYSTEM_TITLE?></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=yes, maximum-scale=1.0, minimum-scale=0.2, width=1400" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<!-- <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css" /> -->
<link rel="stylesheet" type="text/css" href="/lib/js/themes/redmond/jquery-ui.custom.css?20150902" />
<link rel="stylesheet" type="text/css" href="/lib/js/jqgrid/css/ui.jqgrid.custom.css?20150902" />
<link rel="stylesheet" type="text/css" href="/css/validationEngine.jquery.css?20150902" />
<link rel="stylesheet" type="text/css" href="/css/default.css?20161214" />
<link rel="stylesheet" type="text/css" href="/css/reset.css?20150902" media="print" />


<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.layout.js"></script>
<script src="/js/jquery.layout.state.js"></script>
<script src="/lib/js/jqgrid/js/i18n/grid.locale-kr.js"></script>
<script src="/lib/js/jqgrid/js/jquery.jqGrid.min.js"></script>
<!-- <script src="/lib/js/themes/jquery-ui.min.js"></script> -->
<script src="/js/jquery-ui.js"></script>
<script src="/js/jquery.validationEngine-kr.js"></script>
<script src="/js/jquery.validationEngine.js"></script>
<script src="/js/common.js?20161111"></script>
<script src="/js/jquery.form.js"></script>
<script src="/js/jquery.highlight.js"></script>
<script src="/js/jquery.scrollLock.js"></script>
<script src="/js/jquery.cookies.js"></script>
<script src="/js/bootstrap.tooltip.js"></script>
<script src="/js/jquery.MultiFile.pack.js?11"></script>


<!-- <script src="/js/require.js"></script> -->
<script>
	// var myLayout;
	$(document).ready(function() {
		// myLayout = $('body').layout({
		// 	north__minSize : 50,
		// 	north__maxSize : 50,
		// 	west__maxSize : 150,
		// 	west__minSize : 150,
		// 	west__showOverflowOnHover : true,
		// 	stateManagement__enabled:	false
		// });

		DefaultLayout.init();
		//init_menu();

		$('#msg-area').dialog({
			autoOpen : false,
			width : 300,
			resizable : true,
			modal : true,
			buttons : {
				"닫기" : function() {
					$(this).dialog("close");
				}
			}
		});

		$('#layer-area').dialog({
			autoOpen : false,
			width : 650,
			height : 600,
			resizable : true,
			position : {
				at : "right top"
			},
			show : {
				effect : "blind"
			},
			buttons : {
				"닫기" : function() {
					$(this).dialog("close");
				}
			}
		});

		$('#helper-area').dialog({
			autoOpen : false,
			width : 400,
			height : 750,
			resizable : false,
			position : {
				at : "right top"
			},
			show : {
				effect : "blind",
				duration : 500
			}
		});

		$('#passwd-area').dialog({
			autoOpen : false,
			width : 500,
			height : 300,
			modal : true,
			buttons : {
				"닫기" : function() {
					$(this).dialog("close");
				}
			}
		});


		//global_biz_id
		$( "select#global_biz_id" ).change(function() {
			var biz_id = $(this).val();
			$.ajax({
				url:'/login/change_biz',
				data:{
					biz_id:biz_id
				},
				dataType:'json',
				type:'POST',
				success: function(r) {
					if(r.success){
						document.location.reload();
					}
					else {
						alert(r.msg);
					}
				}
			})
		});


		$( "select#global_biz_id" ).val("<?=$this->session->userdata( 'ss_biz_id' )?>");

		<? if ($this->session->userdata( 'ss_dept_code' ) == '90'): ?>
		$.ajax({
			type : "POST",
			url : "/consulting/unconfirm_total",
			data : "",
			success : function(result_data) {
				$("#alarm-consulting p").html(result_data);
				if(result_data > 0) $("#alarm-consulting").fadeIn();
			}
		});
		<? endif; ?>

		$("#check-area").dialog({
			autoOpen : false,
			width : 750,
			height : 300,
			resizable : false,
			modal : true,
			show : {
				effect : "blind"
			},
			buttons : {
				"닫기" : function() {
					$(this).dialog("close");
				}
			}
		});

		
	    $(document).bind("contextmenu  selectstart",function(e){ //dragstart
	        return false;
	    });

	    //파폭
	    disableSelection($("body")[0]);

		$( "#ceo_menu" ).click(function() {
			if ($('.floating-menu').css("display") == "none") {
				$('#bt-floating').html("닫기");
				$.cookie('ceo_menu', 'open',{ path:'/' });

			} else {
				$('#bt-floating').html("열기");
				$.cookie('ceo_menu', 'close',{ path:'/' });
			}
			$('.floating-menu').slideToggle();

		});
	});

	var DefaultLayout = {
		init : function() {
			var ceo_menu = $.cookie('ceo_menu');
			if(ceo_menu=='close') {
				$('#bt-floating').html("열기");
				$('.floating-menu').css('display','none');
			}

			$('[data-toggle="tooltip"]').tooltip();

			$("button:not(.btn), input[type=button]").button();
			$("button[type!=submit]:not(.btn)").button().click(function(event) {
				event.preventDefault();
			});
		}
	}

	function init_menu() {
		$('#menu li a').click(function() {
			$(this).next().slideToggle('normal');
		});
	}


	function open_calendar(target_id) {
		$(function() {
			var dates = $(target_id).datepicker(datepicker_option,{
				onSelect : function(selectedDate) {
					var option = this.id == "from" ? "minDate"
							: "maxDate", instance = $(this)
							.data("datepicker"), date = $.datepicker
							.parseDate(
									instance.settings.dateFormat
											|| $.datepicker._defaults.dateFormat,
									selectedDate,
									instance.settings);
					dates.not(this).datepicker("option",
							option, date);
				}
			});
		});
	}

	function open_ing() {

		var title = 'DB분배현황';
		var modal = new HmisModal('assign_status', {width:700, top:200});
		modal.callback = this.load;
		modal.open(title,'/assign/ing');
	}

	function open_helper() {
		var is_open = $('#helper-area').dialog( "isOpen" );
		if (is_open) $('#helper-area').dialog("close");
		else $('#helper-area').dialog("open");
	}

	function open_password() {
		var modal = new HmisModal('password_change', {width:600});
		modal.open('비밀번호 변경','/manage/password');
		// $("#passwd-area").load("/manage/password");
		// $('#passwd-area').dialog("open");
	}

	// 20170220 kruddo : 대표님 모바일 버전 로그인 시 PC버전 보기 기능 추가
	function device_link(d) {
		if(d=="M"){
			location.href="http://m.cmltd.kr/main";
		}
		else{
			location.href="http://cmltd.kr/treat/schedule";
		}
	}
	// 20170220 kruddo : 대표님 모바일 버전 로그인 시 PC버전 보기 기능 추가

	function open_check() {
		$( "#check-area" ).load( "/consulting/search_main");
		$( "#check-area" ).dialog("open");
	}

</script>

</head>

<body>
	<div id="layer-area" title="DB 분배현황"></div>
	<div id="msg-area" title="msg"></div>
	<div id="passwd-area" title="비밀번호 변경"></div>
	<div id="check-area" title="고객중복체크"></div>

	<div class="layout-wrapper">
		<div class="layout-header">
			<? $this->load->view( '_layouts/top'); ?>
		</div>
		<div class="layout-center">
			<div class="row">
				<div class="layout-west">
					{left}
					<div id="helper-area" title="도움말" style="display: none;">
					<? $this->load->view( '_layouts/helper'); ?>
					</div>
				</div>
				<div class="layout-east">
					<div id="title-area">{page_title} <span style="font-size:11px;padding-left:10px;color:#616161">{page_navigator}</span></div>
					<? if($this->grant_view){?>

					<div class="area-body" style="width:{page_width}">
						{yield}
					</div>
					<? } else {?>
						<div style="background-color:#EBEBEB;padding:50px;width:500px;margin:100px auto">

							<div style="text-align:center;color:#E84E40;font-size:20px;"><i class="fa fa-comments"></i> 이 메뉴를 이용할 권한이 없습니다.</div>
						</div>
					<?} ?>
				</div>
				<div class="layout-south">Copyright ⓒ 2014 By Mltdb All right's Reserved</div>
			</div>
		</div>
	</div>
</body>
</html>
