<form id="FrmPatientManager">
<input type="hidden" name="patient_no" value="{patient_no}" />
<table class="table table-bordered table-form">
	<colgroup>
		<col style="width:120px" />
		<col />
	</colgroup>
	<tr>
		<th>팀변경</th>
		<td>
			<select name="manager_team_code" id="manager_team" class="validate[required] required" onchange="HmisCommon.loadUser(this.value, '', 'manager')" data-errormessage-value-missing="담당팀을 선택하세요">
				<option value="">::팀::</option>
				{@ cfg.team}
				<option value="{.key_}">{.value_}</option>
				{/}				
			</select>
			<select name="manager_id" id="manager_user" style="display:none" class="validate[required] required" data-errormessage-value-missing="담당실장을 선택하세요">
				<option value="">::팀원::</option>
			</select>
		</td>
	</tr>
</table>

<div class="well" style="margin-top:5px">
	<span class="label label-error">도움말</span> 환자의 모든 정보에서 담당실장 정보가 변경됩니다.
</div>
<div class="area-button">
	<button type="submit" class="btn btn-theme btn-lg">변경</button>
	<button type="button" class="btn btn-gray btn-lg modal-close">닫기</button>
</div>
</form>

<script type="text/javascript">
var PatientManager = {
	init: function() {
		var me = this;
		var option = $.extend({},validation_option, {
			onValidationComplete: function(form, status){
				if(status) me.save();
			}
		});

		$("#FrmPatientManager").validationEngine('attach',option);
	},
	save: function() {
		HmisAlert.confirm('변경사항을 적용하시겠습니까?', function(r) {
			if(r) {
				var formdata = $('#FrmPatientManager').serialize();
				$.ajax({
					url:'/patient_proc/save_patient_manager',
					data:formdata,
					dataType:'json',
					type:'POST',
					success: function(r){
						HmisAlert.alert(r.msg, function() {
							if(r.success) {
								PatientInfo.render();
								$('.modal-close').trigger('click');	
							}	
						});
						
					}
				})
			}
		})
	}
}

$(function() {
	PatientManager.init();
})
</script>