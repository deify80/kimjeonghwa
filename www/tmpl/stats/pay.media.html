<form id="FrmPayMediaSearch">
	<input type="hidden" name="date_s" value="{search.date_s}" />
	<input type="hidden" name="date_e" value="{search.date_e}" />
	<input type="hidden" name="tab" value="media" />
	<input type="hidden" name="media" value="" />
	<input type="hidden" name="pay_field" value=""/>
</form>

<style type="text/css">
.total td{background-color:#F7F7F7;}
.total td .f-null {color:#000;font-family:'NGB'}
#div_detail {float:right;width:40%;padding-left:20px;}
.area-title { margin-top:0px; }
</style>

<div style="width:60%;float:left">
	<h3 class="area-title">미디어별 매출통계</h3>
	<table class="table table-bordered table-center table-form table-hover" >
		<colgroup>
			<col width="100px">
		</colgroup>
		<thead>
			<tr>
				<th>미디어그룹</th>
				<th>미디어항목</th>
				<th>OP매출액</th>
				<th>예치금</th>
				<th>미수금</th>
				<th>환불액</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<th colspan="2">합계</th>
				<th>{=number_format(total.basic)}</th>
				<th>{=number_format(total.paid)}</th>
				<th>{=number_format(total.unpaid)}</th>
				<th>{=number_format(total.refund)}</th>
			</tr>
			{@ list}
			<tr data-route="{.key_}">
				<th rowspan="{.count}">{.name}</th>
				{@ .children}

				{? ..index_ >0}<tr  data-route="{.key_}_{..key_}"  class="{..key_}">{/}

				<td>{..title}</td>
				<td>
					{? ..sales.basic != 0 && ..key_!='total'}
					<a href="javascript:;" class="link" onclick="PayMedia.loadDetail('{..key_}','basic')">{=number_format(..sales.basic)}</a>
					{:}
					<span class="f-null">{=number_format(..sales.basic)}</span>
					{/}
				</td>

				<td>
					{? ..sales.paid != 0 && ..key_!='total'}
					<a href="javascript:;" class="link" onclick="PayMedia.loadDetail('{..key_}','paid')">{=number_format(..sales.paid)}</a>
					{:}
					<span class="f-null">{=number_format(..sales.paid)}</span>
					{/}
				</td>
				<td>
					{? ..sales.unpaid != 0 && ..key_!='total'}
					<a href="javascript:;" class="link" onclick="PayMedia.loadDetail('{..key_}','unpaid')">{=number_format(..sales.unpaid)}</a>
					{:}
					<span class="f-null">{=number_format(..sales.unpaid)}</span>
					{/}
				</td>
				<td>
					{? ..sales.refund != 0 && ..key_!='total'}
					<a href="javascript:;" class="link" onclick="PayMedia.loadDetail('{..key_}','refund')">{=number_format(..sales.refund)}</a>
					{:}
					<span class="f-null">{=number_format(..sales.refund)}</span>
					{/}
				</td>

				{? ..index_ >0}</tr>{/}

				{:}
				<td colspan="3" class="left f-null">등록된 미디어코드가 없습니다.</td>
				{/}
			</tr>
			{/}

		</tbody>
	</table>
</div>
<div id="div_detail">
	<h3 class="area-title" style="color:#FF8000">매출액을 클릭하면 상세내역을 확인할 수 있습니다</h3>
</div>
<div style="clear:both"></div>

<script type="text/javascript">
var PayMedia = {
	init: function() {
	},
	loadDetail: function(media, pay_field) {
		$('#FrmPayMediaSearch input[name="media"]').val(media);
		$('#FrmPayMediaSearch input[name="pay_field"]').val(pay_field);
		var formdata = $('#FrmPayMediaSearch').serializeArray();

		$('#div_detail').load('/stats/pay_detail', formdata);
	}
}
</script>
