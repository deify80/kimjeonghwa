<form id="FrmClassifyInput" onsubmit="return false">
<input type="hidden" name="no" value="<?=$rs['no']?>">
<input type="hidden" name="mode" value="<?=$cfg['mode']?>">
<input type="hidden" name="code_parent" value="<?=$rs['code_parent']?>">
<input type="hidden" name="kind" value="<?=$rs['kind']?>">
<table class="table table-bordered table-form">
	<colgroup>
		<col width="120px">
		<col>
	</colgroup>
	<tbody>
		<tr>
			<th>분류코드</th>
			<td>
				<? if($cfg['mode'] == 'insert'){ ?>
				<input type="text" name="code" style="width:80px" class="validate[required,custom[onlyLetterNumber],funcCall[ClassifyInput.checkCode]]" maxlength=4>
				<? } else {?>
				<input type="text" name="code" value="<?=$rs['code']?>" class="transparent" readonly>
				<? } ?>
			</td>
		</tr>
		<tr>
			<th>분류명</th>
			<td><input type="text" name="name" value="<?=$rs['name']?>" class="validate[required]"/></td>
		</tr>
		<tr>
			<th>사용여부</th>
			<td>
				<label class="hmis"><input type="radio" name="is_use" value="Y" <?=($rs['is_use']=='Y')?'checked':''?> class="hmis" /><span class="lbl"> 사용</span></label>
				<label class="hmis"><input type="radio" name="is_use" value="N" <?=($rs['is_use']=='N')?'checked':''?> class="hmis" /><span class="lbl"> 사용안함</span></label>
			</td>
		</tr>
	</tbody>
</table>

<div class="area-button">
	<button type="submit" class="btn btn-theme btn-lg" >저장</button>
	<button type="button" class="btn btn-gray btn-lg modal-close">닫기</button>
</div>

</form>

<script type="text/javascript">
var ClassifyInput = {
	init: function(){
		var me = this;
		var option = $.extend({},validation_option,  {
			promptPosition:'centerRight',
			onValidationComplete: function(form, status){
				if(status) me.save();
			}
		});

		$("#FrmClassifyInput").validationEngine('attach',option);
	},
	checkCode: function(field, rules, i, options) {
		if(field.val().length!=4) {
			return '분류코드는 4자리로 입력하세요.';
		}
	},
	save: function() {
		var formdata = $('#FrmClassifyInput').serialize();
		$.ajax({
			url:'/stock_proc/category_save',
			data:formdata,
			dataType:'JSON',
			type:'POST',
			success: function(r) {
				if(r.success) {
					if("<?=$rs['code_parent']?>"=="000A"){
						StockSettings.loadAnesthesia(r.data.code_real);
					}
					else{
						StockSettings.loadClassify(r.data.code_real);
					}
					$('.modal-close').trigger('click');	
				}
				else {
					alert(r.msg);
				}
				
			}
		})
	}
}

$(function(){
	ClassifyInput.init();
})
</script>

